{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.1", "generated_at": "2024-02-08T13:01:28.245897Z", "invocation_id": "7709c02b-a4ee-4f13-b254-17a0e4ad3eac", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-08T13:01:25.641031Z", "completed_at": "2024-02-08T13:01:25.656158Z"}, {"name": "execute", "started_at": "2024-02-08T13:01:25.657266Z", "completed_at": "2024-02-08T13:01:27.582448Z"}], "thread_id": "Thread-1", "execution_time": 2.5980212688446045, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b236ad-0000-4ee8-0000-a74500022162"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_meds.fct_country_sales", "compiled": true, "compiled_code": "\n\nwith sales_data as (\n    select * from public.raw_data.sales_data\n),\nfiltered_data as (\n    select \n        country,\n        api_sold_product \n    from sales_data\n    where extract(year from sold_product_created_at) = extract(year from current_date) - 1\n    group by 1,2\n    having count(*) >3\n    order by 1\n),\nfinal as (\n    select \n        sales_data.country,\n        sales_data.api_sold_product as product_name,\n        sum(quantity_sold) as total_sold,\n        avg(unit_price) as average_price,\n        min(sold_product_created_at) as first_sale,\n        max(sold_product_created_at) as last_sale\n    from sales_data \n    inner join filtered_data\n    on filtered_data.country=sales_data.country\n    and filtered_data.api_sold_product=sales_data.api_sold_product\n    group by 1,2\n    order by 1,2\n)\nselect \n    country,\n    product_name,\n    total_sold,\n    average_price,\n    first_sale,\n    last_sale\nfrom final", "relation_name": "public.llijo_data.fct_country_sales"}], "elapsed_time": 9.377612113952637, "args": {"which": "build", "macro_debugging": false, "use_colors": true, "cache_selected_only": false, "vars": {}, "resource_types": [], "print": true, "favor_state": false, "populate_cache": true, "partial_parse": true, "defer": false, "use_colors_file": true, "static_parser": true, "log_level_file": "debug", "strict_mode": false, "write_json": true, "invocation_command": "dbt build -s fct_country_sales", "select": ["fct_country_sales"], "partial_parse_file_diff": true, "log_level": "info", "log_path": "/Users/lijolawrance/work/work/dbt_meds_1/logs", "profiles_dir": "/Users/lijolawrance/.dbt", "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "log_format": "default", "version_check": true, "printer_width": 80, "show_resource_report": false, "log_format_file": "debug", "exclude": [], "enable_legacy_logger": false, "include_saved_query": false, "show": false, "project_dir": "/Users/lijolawrance/work/work/dbt_meds_1", "send_anonymous_usage_stats": true, "quiet": false, "log_file_max_bytes": 10485760, "indirect_selection": "eager"}}